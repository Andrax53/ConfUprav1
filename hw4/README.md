# Задание 4

# Учебная Виртуальная Машина (УВМ)

## Описание
Данный проект представляет собой реализацию учебной виртуальной машины (УВМ), включающую в себя ассемблер и интерпретатор. УВМ поддерживает набор базовых команд для работы с памятью и регистрами, а также специальные операции, такие как byte swap.

## Структура проекта
- `uvm.py` - основной файл с реализацией ассемблера и интерпретатора
- `test_vm.py` - модульные тесты
- `test_program.asm` - пример программы на ассемблере
- `program.log` - лог-файл с информацией о скомпилированных инструкциях
- `result.yaml` - файл с результатами работы программы

## Система команд
1. `load_const` - загрузка константы в регистр
   - Формат: `load_const регистр, константа`
   - Размер: 6 байт (1 байт опкод, 1 байт регистр, 4 байта константа)
   - Пример: `load_const 1, 0x12345678`

2. `read_memory` - чтение из памяти
   - Формат: `read_memory цель, база, смещение`
   - Размер: 6 байт (1 байт опкод, 1 байт цель, 1 байт база, 1 байт смещение, 2 байта padding)
   - Пример: `read_memory 2, 0, 0`

3. `write_memory` - запись в память
   - Формат: `write_memory база, смещение, источник`
   - Размер: 6 байт (1 байт опкод, 1 байт база, 1 байт смещение, 1 байт источник, 2 байта padding)
   - Пример: `write_memory 0, 0, 1`

4. `bswap` - операция byte swap (меняет порядок байтов на противоположный)
   - Формат: `bswap источник, цель`
   - Размер: 4 байта (1 байт опкод, 1 байт источник, 1 байт цель, 1 байт padding)
   - Пример: `bswap 2, 2`

## Пример программы
```asm
# Инициализация вектора и выполнение byte swap
load_const 0, 100              # Загрузка базового адреса
load_const 1, 0x12345678      # Загрузка значения
write_memory 0, 0, 1          # Запись в память[100]
read_memory 2, 0, 0           # Чтение из памяти[100]
bswap 2, 2                    # Изменение порядка байтов
write_memory 0, 0, 2          # Запись результата обратно
```

## Использование

### Требования
- Python 3.6+
- PyYAML

### Установка зависимостей
```bash
pip install pyyaml
```

### Запуск программы
```bash
python uvm.py test_program.asm output.bin program.log result.yaml "100,5"
```

Где:
- `test_program.asm` - входной файл с программой на ассемблере
- `output.bin` - выходной бинарный файл
- `program.log` - лог работы программы
- `result.yaml` - файл с результатами (значения памяти)
- `"100,5"` - диапазон памяти (начальный адрес и длина)

### Формат результатов
Результаты выполнения программы сохраняются в YAML файле в следующем формате:
```yaml
memory_values:
  100: '0x78563412'  # Значения в памяти после выполнения программы
  101: '0xDDCCBBAA'
  102: '0x21436587'
  103: '0x98BADCFE'
  104: '0x44332211'